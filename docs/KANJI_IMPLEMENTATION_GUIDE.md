# 漢字レベル機能実装ガイド

## 概要

このガイドは、アプリケーションで漢字レベル機能を実装する際の指針を提供します。

## 実装済み機能

### 1. 漢字レベルセレクター
- 場所: `src/components/KanjiGradeSelector.tsx`
- 機能: 小学1年生〜6年生の選択
- 表示条件: 日本語モード時のみ

### 2. コンテキスト管理
- 場所: `src/contexts/LanguageContext.tsx`
- 状態: `kanjiGrade` (1-6)
- 型定義: `KanjiGrade = 1 | 2 | 3 | 4 | 5 | 6`

### 3. 実装済みページ
- **VocabularyGamePage**: 各文章に `jaKanji` フィールドで学年別表記を管理
- **StoryPage**: 各ページに `jaKanji` フィールドで学年別表記を管理

## 実装パターン

### 1. データ構造

```typescript
interface ContentWithKanji {
  id: string;
  english: string;
  japanese: string; // 基本形（ひらがな中心）
  jaKanji: {
    1: string; // 小1レベル
    2: string; // 小2レベル
    3: string; // 小3レベル
    4: string; // 小4レベル
    5: string; // 小5レベル
    6: string; // 小6レベル
  };
}
```

### 2. 表示ロジック

```typescript
const { language, kanjiGrade } = useLanguage();

// 表示する日本語を決定
const displayText = language === 'ja' 
  ? content.jaKanji[kanjiGrade]
  : content.english;
```

## 漢字レベル別作成ガイドライン

### 小学1年生（80字）
- ほぼひらがな表記
- 数字、基本的な漢字のみ使用
- 例: `わたしは 一年生です。`

### 小学2年生（240字）
- 基本的な動詞、名詞を漢字表記
- 例: `私は 毎朝 学校に 行きます。`

### 小学3年生（440字）
- 日常的な漢字を積極的に使用
- 例: `私は 毎朝 朝食を 食べてから 学校に 行きます。`

### 小学4年生（642字）
- より複雑な概念の漢字を使用
- 例: `私は 健康のために 毎朝 栄養のある 朝食を 食べています。`

### 小学5年生（835字）
- 抽象的な概念も漢字表記
- 例: `私は 健康維持のために 毎朝 栄養価の高い 朝食を 摂取しています。`

### 小学6年生（1,026字）
- 可能な限り漢字を使用
- 例: `私は 健康維持の観点から 毎朝 栄養価の高い 朝食を 摂取することを 習慣にしています。`

## 実装チェックリスト

新しいコンテンツを追加する際は、以下を確認してください：

- [ ] 6段階の漢字レベルを用意したか
- [ ] 各レベルで適切な漢字を使用しているか
- [ ] 未習漢字にルビが必要な箇所はないか
- [ ] 文章の意味が各レベルで一貫しているか
- [ ] 漢字の使用が自然で読みやすいか

## ヘルパー関数の使用

`src/data/kanjiData.ts` で提供される関数：

```typescript
// 学習済み漢字の取得
const learned = getLearnedKanji(3); // 小3までの漢字

// 未習漢字の検出
const unlearned = getUnlearnedKanji("私は勉強が好きです", 2);
// → ["勉", "強", "好"] (小2では未習)
```

## 今後の拡張案

1. **自動ルビ振り機能**
   - 未習漢字に自動的にふりがなを付ける

2. **漢字ハイライト機能**
   - 新出漢字を色分けして表示

3. **漢字学習モード**
   - 漢字をクリックして読み方や意味を確認

4. **カスタム漢字レベル**
   - ユーザーが個別に学習済み漢字を管理

5. **漢字統計表示**
   - 使用漢字数、新出漢字数などの表示

## 注意事項

1. **パフォーマンス**
   - 大量のテキストで漢字レベルを切り替える際の描画性能に注意

2. **一貫性**
   - 同じ単語は同じレベルで同じ表記を使用

3. **自然さ**
   - 機械的な置換ではなく、自然な日本語表現を心がける

4. **アクセシビリティ**
   - スクリーンリーダーでの読み上げも考慮

## 参考資料

- `/docs/KANJI_REFERENCE.md` - 学年別漢字一覧
- `/docs/kanji-grade-1.json` - 小1漢字データ
- `/docs/kanji-grade-2.json` - 小2漢字データ
- `/src/data/kanjiData.ts` - 漢字データ管理ユーティリティ